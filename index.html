<!DOCTYPE html>
<html>
<head>
	<title>Bad Optics Collective</title>

	<!-- Fonts -->
	<!-- <link href="https://fonts.googleapis.com/css?family=Open+Sans|Ubuntu" rel="stylesheet""> -->
	<!-- Style -->
	<link rel="stylesheet" href="static/style.css">

	<!-- Scripts -->
	<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>-->
	<script src="static/js/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
</head>

<body>
	<!-- no-script version -->
	<noscript class="antialias" class="text-mono antialias">
		<div id="header">
			<div id="infoHeader">
				<a href="/subscribe" class="unstyle-link">subscribe</a>
			</div>
			<div id="logoHeader">
				<div class="logo-line-spacer"></div>
				<div class="logo-line"></div>
				<div id="logoWrapper">
					<img id="logo" src="static/bad-optics-borderless.png" alt="Bad Optics">
				</div>
				<div class="logo-line"></div>
				<div class="logo-line-spacer"></div>
			</div>

			<div id="noscriptMessage">
				<p>invalid [[javascript-state]] => enable javascript</p>
			</div>
		</div>
	</noscript>

	<!-- tile popup scrim -->
	<div id="popupScrim"></div> 

	<div id="header" class="text-mono antialias">
		<div id="infoHeader">
			<a href="/subscribe" class="unstyle-link">subscribe</a>
			<a href="#about" class="unstyle-link">about us</a>
		</div>
		<div id="logoHeader">
			<div class="logo-line-spacer"></div>
			<div class="logo-line"></div>
			<div id="logoWrapper">
				<a href="#all">
					<img id="logoInvert" src="static/bad-optics-borderless-invert.png" alt="Bad Optics Invert">
					<img id="logo" src="static/bad-optics-borderless.png" alt="Bad Optics">
				</a>
				<svg id="logoInvertSpot" width="100%" height="100%">
					<circle cx="18.75%" cy="68.70%" r="12.17%" fill="white" />
				</svg>
			</div>
			<div class="logo-line"></div>
			<div class="logo-line-spacer"></div>
		</div>
	</div>

	<div id="mainNav" class="text-header antialias">
		<div style="position: relative; display: inline-block; margin: auto;">
			<div id="mainNavHeader">
				<span>Expressions</span>
			</div>

			<div id="mainNavWrapper" class="text-sans-web" style="font-weight: 200;">
				<div class="nav-choices">
					<a href="#sonic" id="sonicChoiceContainer" class="choice-container unstyle-link">
						<span>Sonic<div class="choice-hover"></div></span>
					</a>
					<a href="#visual" id="visualChoiceContainer" class="choice-container unstyle-link">
						<span>Visual<div class="choice-hover"></div></span>
					</a>
					<a href="#interactive" id="interactiveChoiceContainer" class="choice-container unstyle-link">
						<span>Interactive<div class="choice-hover"></div></span>
					</a>
				</div>
				<div id="mainNavUnderline"></div>
			</div>

			<div class="empty-message text-mono antialias">
				<div>
					<span></span>
				</div>
			</div>
		</div>
	</div>

	<div id="mainContent">
		<div class="tile-set text-sans antialias">
			<div class="tile sonic-tile" style="background-image: url('static/powers-that-b.jpg');">
				<div class="tile-content-container">
					<div class="tile-content">
						<img src="static/powers-that-b.jpg" alt="The Powers That B" class="tile-content-header-image">
						<div>
							<span class="text-small text-mono">[[sonic]]</span>
							<br>
							<span class="text-large">The Powers That B</span>
							<br>
							<span class="text-medium">Death Grips</span>
							</p>
							<p class="text-regular">woopdy scoop</p>
						</div>
					</div>
				</div>
				<div class="tile-borders">
					<div class="tile-title-text text-sans-web" style="font-weight: 200">
						<span>&#x227C;<span class="issue-number">s/001</span>&#x227D;</span>
					</div>
					<div class="tile-border tile-border-top"></div>
					<div class="tile-border tile-border-right"></div>
					<div class="tile-border tile-border-bottom"></div>
					<div class="tile-border tile-border-left"></div>
				</div>
			</div>
			<div class="tile visual-tile">
				<div class="tile-content-container">
					<div class="tile-content">
						<p style="text-align: center;">ineed all my bitches same color as thanos</p>
					</div>
				</div>
				<div class="tile-borders">
					<div class="tile-title-text text-sans-web" style="font-weight: 200">
						<span>&#x227C;<span class="issue-number">v002</span>&#x227D;</span>
					</div>
					<div class="tile-border tile-border-top"></div>
					<div class="tile-border tile-border-right"></div>
					<div class="tile-border tile-border-bottom"></div>
					<div class="tile-border tile-border-left"></div>
				</div>
			</div>
			<div class="tile sonic-tile">
				<div class="tile-content-container">
					<div class="tile-content">
						<img src="static/knuckles.jpg" style="height: 100%;">
					</div>
				</div>
				<div class="tile-borders">
					<div class="tile-title-text text-sans-web" style="font-weight: 200">
						<span>&#x227C;<span class="issue-number">s/003</span>&#x227D;</span>
					</div>
					<div class="tile-border tile-border-top"></div>
					<div class="tile-border tile-border-right"></div>
					<div class="tile-border tile-border-bottom"></div>
					<div class="tile-border tile-border-left"></div>
				</div>
			</div>
			<div class="tile visual-tile">
				<div class="tile-content-container">
					<div class="tile-content">
						<p style="text-align: center;">matt's first album</p>
					</div>
				</div>
				<div class="tile-borders">
					<div class="tile-title-text text-sans-web" style="font-weight: 200">
						<span>&#x227C;</span><span class="issue-number">v004</span><span>&#x227D;</span>
					</div>
					<div class="tile-border tile-border-top"></div>
					<div class="tile-border tile-border-right"></div>
					<div class="tile-border tile-border-bottom"></div>
					<div class="tile-border tile-border-left"></div>
				</div>
			</div>
			<div class="tile sonic-tile">
				<div class="tile-content-container">
					<div class="tile-content">
						<p style="text-align: center;">benis</p>
					</div>
				</div>
				<div class="tile-borders">
					<div class="tile-title-text text-sans-web" style="font-weight: 200">
						<span>&#x227C;<span class="issue-number">s/005</span>&#x227D;</span>
					</div>
					<div class="tile-border tile-border-top"></div>
					<div class="tile-border tile-border-right"></div>
					<div class="tile-border tile-border-bottom"></div>
					<div class="tile-border tile-border-left"></div>
				</div>
			</div>
		</div>
	</div>

	<div id="footer" class="text-mono antialias">
		<span>&copy; 2019 Bad Optics Collective. All Rights Reserved.</span>
	</div>

	<!-- Working Scripts -->
	<!-- WEB FONT LOADING -->
	<!--<script type="text/javascript">
		WebFontConfig = {
		    google: {
		      families: ['Open Sans', 'Ubuntu:300,400']
		    },
		    active: function() {
		    	$(window).trigger('hashchange');
		    },
		    inactive: function() {
		    	$(window).trigger('hashchange');
		    	$('html').addClass('wf-active');
		    },
		    timeout: 1000,
		};
		WebFont.load(WebFontConfig);
	</script>-->
	<!-- TILE SCRIPT -->
	<script type="text/javascript">
		// Tile content initializer
		let tile_content_top_offset = 30;

		function set_tile_content_container_positions() {
			$('.tile-content-container').each(function() {
				// Uninitialize tile
				$(this).removeClass('initialized');
				$(this).css('margin-bottom', '');
				$(this).css('height', '');
				// Set tile-content top position
				let tile = $(this).parent();
				let tile_top = $(tile).position().top;
				let tile_height = $(tile).outerHeight(true);
				let top_val = tile_top + tile_height + tile_content_top_offset;
				$(this).css('top', top_val+'px');
				// Set tile-content height and tile margin-bottom
				let tile_content_outer_height = $(this).outerHeight(true);
				tile.css('margin-bottom', tile_content_outer_height+'px');
				let tile_content_height = $(this)[0].getBoundingClientRect().height;
				$(this).css('height', tile_content_height+'px');
				// Set tile-content to initialized
				$(this).addClass('initialized');
			});
		}
		set_tile_content_container_positions();

		// Tile click handler
		const tile_show_transition_duration = 200;
		let tile_show_timeout = null;

		$('.tile').bind('click', function() {
			if($(this).hasClass('show')) {
				$(this).removeClass('show');
				$(this).removeClass('selected');
			}
			else {
				clearTimeout(tile_show_timeout);
				$('.tile.selected').removeClass('selected');
				$(this).addClass('selected');
				if(tile_show_timeout !== null || $('.tile.show').length > 0) {
					$('.tile.show').removeClass('show');
					tile_show_timeout = setTimeout((() => {
						$(this).addClass('show');
						tile_show_timeout = null;
					}).bind(this), 
					tile_show_transition_duration+10);
				}
				else {
					$(this).addClass('show');
				}
			}
		});
	</script>
	<!-- MAIN NAV SETTINGS -->
	<script type="text/javascript">
		// Function for opening and closing empty message box with details
		function closeEmptyMessage() { 
			$('.empty-message').removeClass('show');
		}
		function openEmptyMessage(media_type) {
			let empty_message = $('.empty-message');
			$(empty_message).removeClass('show');
			if(media_type !== '') {
				// Get div and span
				let empty_message_div = $('.empty-message div');
				let empty_message_span = $('.empty-message span');
				// Uninitialize to reset width
				$(empty_message).removeClass('initialized');
				$(empty_message_div).css('width', '');
				(empty_message_span).css('width', '');
				// Set text
				$(empty_message_span).text('media-type [['+media_type+']] => not found');
				// Adjust width
				let span_rect = $(empty_message_span)[0].getBoundingClientRect();
				$(empty_message_div).css({
					'height': span_rect.height,
					'width': span_rect.width,
				})
				$(empty_message_span).css('width', span_rect.width);
				// Re-initiailize
				$(empty_message).addClass('initialized');
			}
			setTimeout(() => $(empty_message).addClass('show'), 100);
		}

		// NavHeader filter reset
		$('#mainNavHeader span').bind('click', function(e) {
			window.location.hash = '#all';
			e.preventDefault();
		});

		// Hash change handler
		const main_fade_duration = 500;
		let main_fade_timeout = null;
		const crawl_speed = 200;
		let cur_crawl_timeout;

		$(window).bind('hashchange', function(e) {
			let hash = location.hash.toLowerCase();
			let hash_word = hash.substr(1);
			let nav_choices = $('#mainNavWrapper .nav-choices').children('.choice-container');
			let container_id = hash + 'ChoiceContainer';
			// Unselect any selected choices
			nav_choices.not(container_id).removeClass('selected');
			// Select proper choice
			let selected_choice_container = $(nav_choices).filter(container_id);
			$(selected_choice_container).addClass('selected');

			// Adjust css on under-line
			let underline = $('#mainNavUnderline');
			if($(selected_choice_container).length === 0) {
				underline.css('left', 0);
				underline.css('right', 0);
			}
			else {
				// Cancel current timeout crawl
				clearTimeout(cur_crawl_timeout);
				// Get new left and right values
				let nav_width = $('#mainNavWrapper')[0].getBoundingClientRect().width;
				let selected_span = $(selected_choice_container).children('span');
				let selected_position = $(selected_span).position();
				let selected_width = $(selected_span)[0].getBoundingClientRect().width;
				let left_val = selected_position.left;
				let right_val = nav_width - (left_val + selected_width);
				let cur_left = parseInt(underline.css('left'), 10);
				let cur_right = parseInt(underline.css('right'), 10);
				let left_val_perc = (left_val/nav_width)*100.0;
				let right_val_perc = (right_val/nav_width)*100.0;
				// If currently fully stretched, instantly focus on target
				if(cur_left === 0 && cur_right === 0) {
					underline.css('left', left_val_perc+'%');
					underline.css('right', right_val_perc+'%');
				}
				// Otherwise crawl towards it
				else {
					// Crawl right
					if(left_val > cur_left) {
						underline.css('right', right_val_perc+'%');
						cur_crawl_timeout = setTimeout(function() {
							underline.css('left', left_val_perc+'%');
						}, crawl_speed);
					}
					// Crawl left
					else {
						underline.css('left', left_val_perc+'%');
						cur_crawl_timeout = setTimeout(function() {
							underline.css('right', right_val_perc+'%');
						}, crawl_speed);
					}
				}
			}

			// Close drop-down box
			$('.tile').removeClass('show selected');

			// Perform action dependent on choice
			clearTimeout(main_fade_timeout);

			if(!(hash_word === 'sonic' || hash_word === 'visual' || hash_word === 'interactive')) {
				hash_word = '';
			}

			let tile_class = '.'+hash_word+'-tile';
			let tiles = $('#mainContent .tile');
			let matching_tiles = $(tiles).filter(tile_class);
			if(hash_word === '') {
				if($(tiles).length > 0)
					closeEmptyMessage();
				else
					openEmptyMessage('all');
			}
			else {
				if($(matching_tiles).length > 0)
					closeEmptyMessage();
				else
					openEmptyMessage(hash_word);
			}

			let filterTiles = function() {
				if(hash_word === '') {
					if($(tiles).length > 0) {
						$(tiles).show();
						set_tile_content_container_positions();
						$(main_content).removeClass('hidden');
					}
				}
				else {
					$(tiles).not(tile_class).hide();
					if($(matching_tiles).length > 0) {
						$(matching_tiles).show();
						set_tile_content_container_positions();
						$(main_content).removeClass('hidden');
					}
				}
			}

			let main_content = $('#mainContent');
			if(!main_fade_timeout && $(main_content).hasClass('hidden')) {
				console.log('hi');
				filterTiles();
				$(main_content).removeClass('hidden');
			}
			else {
				$(main_content).addClass('hidden');
				main_fade_timeout = setTimeout(() => {
					filterTiles();
					main_fade_timeout = null;
				}, main_fade_duration);
			}
		});
	</script>
	<!-- INVERT SCRIPT -->
	<script type="text/javascript">
		$('#logoInvertSpot circle').bind('click', function() {
			$('html').toggleClass('invert');
		});
	</script>
	<!-- LOADED SCRIPT -->
	<script type="text/javascript">
		function setHtmlLoaded() {
			$('html').addClass('loaded');
		}
		$(document).ready(function() {
			setTimeout(setHtmlLoaded, 50);
			$(window).trigger('hashchange');
		});
	</script>
</body>
</html>